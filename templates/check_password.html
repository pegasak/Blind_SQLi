{% extends "base.html" %}

{% block title %}Check Password{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Check Password (Blind SQL Injection)</h2>
    <form action="/check_password" method="post" class="form-group">
        <label for="user">Username:</label>
        <input type="text" id="user" name="user" class="form-control" required>
        
        <label for="condition" class="mt-3">SQL Condition:</label>
        <input type="text" id="condition" name="condition" class="form-control" required placeholder="e.g., LENGTH(password) = 12">
        
        <button type="submit" class="btn btn-primary mt-3">Check</button>
    </form>
    
    <div id="result" class="mt-4"></div>
</div>

<script>
    document.querySelector("form").addEventListener("submit", function(event) {
        event.preventDefault();
        let formData = new FormData(this);
        
        fetch("/check_password", {
            method: "POST",
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("result").innerHTML = `<div class='alert ${data.success ? 'alert-success' : 'alert-danger'}'>Result: ${data.success}</div>`;
        })
        .catch(error => console.error("Error:", error));
    });
</script>
{% endblock %}
